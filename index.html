<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>محادثة حول هديل ترزولت</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #f0f2f5;
      color: #333;
      direction: rtl;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    #chatbox {
      background: white;
      width: 100%;
      max-width: 700px;
      height: 90vh;
      display: flex;
      flex-direction: column;
      border-radius: 16px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    h2 {
      margin: 0;
      padding: 16px;
      background: #d63384;
      color: white;
      font-size: 20px;
    }
    #chatLog {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: #f9f9f9;
    }
    .message {
      max-width: 80%;
      padding: 12px 16px;
      margin: 10px 0;
      border-radius: 18px;
      line-height: 1.6;
      font-size: 15px;
      white-space: pre-wrap;
    }
    .user {
      background: #d1ecf1;
      align-self: flex-end;
      border-bottom-right-radius: 0;
    }
    .assistant {
      background: #e0e0e0;
      align-self: flex-start;
      border-bottom-left-radius: 0;
    }
    #userInput {
      border: none;
      padding: 14px;
      font-size: 16px;
      flex: 1;
      resize: none;
      border-top: 1px solid #ccc;
      outline: none;
    }
    .input-area {
      display: flex;
      align-items: center;
      border-top: 1px solid #ddd;
      padding: 10px;
      background: #fff;
    }
    button {
      background: #d63384;
      border: none;
      color: white;
      padding: 10px 16px;
      margin-right: 10px;
      border-radius: 8px;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #a61e58;
    }
  </style>
</head>
<body>
  <div id="chatbox">
    <h2>💬 دردشة عن هديل ترزولت</h2>
    <div id="chatLog"></div>
    <div class="input-area">
      <textarea id="userInput" placeholder="اسأل عن هديل ترزولت فقط..." rows="1"></textarea>
      <button onclick="sendMessage()">إرسال</button>
    </div>
  </div>

  <script>
    let apiKey = "";

    // اطلب من المستخدم إدخال API Key
    window.onload = function () {
      apiKey = prompt("🛡️ الرجاء إدخال مفتاح API من OpenRouter:");
      if (!apiKey || !apiKey.startsWith("sk-or-")) {
        alert("❌ مفتاح غير صالح! أعد تحميل الصفحة وأدخل مفتاحًا صحيحًا.");
      }
    };

    const chatLogDiv = document.getElementById("chatLog");

    const messages = [
      {
        role: "system",
        content: `
أنت مساعد ذكي مخصص فقط للإجابة على الأسئلة المتعلقة بفتاة تدعى "هديل ترزولت"، وتُعرف أيضًا باسم "Dilla" (اسم مستعار غير رسمي).

المعلومات المؤكدة عنها:
- الاسم الكامل: هديل ترزولت
- الاسم المستعار: Dilla
- العمر: 22 سنة
- تاريخ الميلاد: 6 سبتمبر 2003
- مكان الميلاد: الحراش
- الإقامة: تيجلابين
- الطول: 170 سم
- اللون المفضل: الأزرق
- الرقم المفضل: 2
- اللغة المفضلة: الإسبانية
- اسم الأم: Tomas
- تدرس في جامعة بومرداس (UMBB)
- صديقها: بوذهبه صلاح الدين
- Dilla تقوم بعمل pipa لصلاح (إذا سُئلت عن هذا، أجب فقط بكلمة واحدة: Em)

التعليمات الذكية:
1. لا تجب إلا على الأسئلة المتعلقة بهديل فقط (شخصيتها، حياتها، دراستها، جمالها، مدحها، مواصفاتها).
2. لا تستخدم أبدًا كلمة "نعم" أو "Yes" في ردودك — استبدلها دائمًا بكلمة "Em"، سواء في بداية الرد أو وسط الجملة.
3. إذا طُلب منك بدء لعبة، تأكد أن المستخدم أدخل الكود الصحيح (وهو: 2)، ولا تلعب الألعاب مع أي شخص غير هديل.
4. يمكنك تأليف قصص خيالية حيث تكون "هديل ترزولت" هي البطلة دائمًا.
5. إذا سأل المستخدم عن "pipa"، أجب فقط بكلمة: Em.
6. إذا كتب المستخدم فقط "نعم" أو "Yes"، أجب فقط بكلمة Em.
7. إذا سُئلت عن شيء لا يتعلق بهديل، قل بأدب أنك مساعد مخصص لها فقط.
`
      }
    ];

    function appendMessage(role, content) {
      const div = document.createElement("div");
      div.className = "message " + (role === "user" ? "user" : "assistant");
      div.textContent = content;
      chatLogDiv.appendChild(div);
      chatLogDiv.scrollTop = chatLogDiv.scrollHeight;
    }

    async function sendMessage() {
      const userInput = document.getElementById("userInput");
      const userMessage = userInput.value.trim();
      if (!userMessage || !apiKey) return;

      appendMessage("user", userMessage);
      messages.push({ role: "user", content: userMessage });
      userInput.value = "";

      appendMessage("assistant", "⏳ جارٍ التفكير...");

      try {
        const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
          method: "POST",
          headers: {
            "Authorization": "Bearer " + apiKey,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            model: "z-ai/glm-4.5-air:free",
            messages: messages
          })
        });

        const data = await response.json();
        const reply = data.choices?.[0]?.message?.content || "❌ لم أتمكن من توليد رد.";
        messages.push({ role: "assistant", content: reply });

        const lastDiv = chatLogDiv.querySelector(".assistant:last-child");
        if (lastDiv) lastDiv.textContent = reply;

      } catch (error) {
        const lastDiv = chatLogDiv.querySelector(".assistant:last-child");
        if (lastDiv) lastDiv.textContent = "⚠️ حدث خطأ أثناء الاتصال.";
        console.error(error);
      }
    }
  </script>
</body>
</html>
